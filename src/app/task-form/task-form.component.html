<div class="task-form-container animate-in" role="main" aria-label="Formulário de criação de tarefas">
  <h3>✨ Criar Nova Tarefa</h3>
  
  <!-- Success Message -->
  <div *ngIf="showSuccessMessage" class="toast success animate-in" role="alert" aria-live="polite">
    <strong>✅ Sucesso!</strong> Tarefa criada com êxito.
  </div>
  
  <form (ngSubmit)="onSubmit()" #taskForm="ngForm" class="task-form">
    <!-- Basic Information -->
    <div class="form-section">
      <h4>Informações Básicas</h4>
      
      <div class="form-group floating-label">
        <input 
          type="text" 
          id="title"
          [class]="getTitleFieldClass()"
          [(ngModel)]="title" 
          name="title"
          placeholder=" "
          (input)="onTitleInput()"
          [attr.aria-describedby]="formErrors['title'] ? 'title-error' : null"
          required>
        <label for="title">Título da Tarefa *</label>
        <div *ngIf="formErrors['title']" 
             class="form-error" 
             id="title-error" 
             role="alert"
             aria-live="polite">
          {{ formErrors['title'] }}
        </div>
      </div>
      
      <div class="form-group">
        <label for="description">Descrição (opcional)</label>
        <textarea 
          id="description"
          class="form-control" 
          [(ngModel)]="description" 
          name="description"
          placeholder="Descreva os detalhes da tarefa..."
          rows="3"
          [attr.aria-describedby]="'desc-help'"></textarea>
        <small id="desc-help" class="form-help">Adicione mais contexto sobre a tarefa</small>
      </div>
    </div>

    <!-- Eisenhower Classification -->
    <div class="form-section">
      <h4>🎯 Classificação da Matriz de Eisenhower</h4>
      
      <div class="checkbox-group" role="group" aria-labelledby="classification-title">
        <label class="checkbox-label enhanced-checkbox">
          <input 
            type="checkbox" 
            [(ngModel)]="is_urgent"
            name="is_urgent"
            [attr.aria-describedby]="'urgent-help'">
          <span class="checkmark" aria-hidden="true"></span>
          <div class="checkbox-content">
            <strong>Urgente</strong>
            <small id="urgent-help">Precisa ser feito rapidamente</small>
          </div>
        </label>
        
        <label class="checkbox-label enhanced-checkbox">
          <input 
            type="checkbox" 
            [(ngModel)]="is_important"
            name="is_important"
            [attr.aria-describedby]="'important-help'">
          <span class="checkmark" aria-hidden="true"></span>
          <div class="checkbox-content">
            <strong>Importante</strong>
            <small id="important-help">Tem alto impacto nos seus objetivos</small>
          </div>
        </label>
      </div>

      <div class="quadrant-preview" 
           [style.border-left-color]="getQuadrantColor()"
           role="status"
           aria-label="Quadrante previsto baseado na classificação">
        <strong>Quadrante previsto:</strong> {{ getQuadrantPreview() }}
      </div>
    </div>

    <!-- Detailed Metrics -->
    <div class="form-section">
      <h4>📊 Métricas Detalhadas</h4>
      
      <div class="form-row">
        <div class="form-group">
          <label for="due_date">Data de Vencimento</label>
          <input 
            type="datetime-local" 
            id="due_date"
            [class]="getDueDateFieldClass()"
            [(ngModel)]="due_date" 
            name="due_date"
            (change)="onDueDateChange()"
            [attr.aria-describedby]="formErrors['due_date'] ? 'date-error' : 'date-help'">
          <small id="date-help" class="form-help">Quando esta tarefa deve ser concluída?</small>
          <div *ngIf="formErrors['due_date']" 
               class="form-error" 
               id="date-error" 
               role="alert"
               aria-live="polite">
            {{ formErrors['due_date'] }}
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="effort_estimate">💪 Esforço Estimado (1-5)</label>
          <input 
            type="range" 
            id="effort_estimate"
            class="form-range enhanced-range" 
            [(ngModel)]="effort_estimate" 
            name="effort_estimate"
            min="1" 
            max="5"
            step="1"
            [attr.aria-describedby]="'effort-help'">
          <div class="range-labels">
            <span>Muito Fácil (1)</span>
            <span class="current-value" aria-live="polite">{{ effort_estimate }}</span>
            <span>Muito Difícil (5)</span>
          </div>
          <small id="effort-help" class="form-help">Quanta energia/tempo será necessário?</small>
        </div>

        <div class="form-group">
          <label for="impact_score">🎯 Impacto Esperado (1-5)</label>
          <input 
            type="range" 
            id="impact_score"
            class="form-range enhanced-range" 
            [(ngModel)]="impact_score" 
            name="impact_score"
            min="1" 
            max="5"
            step="1"
            [attr.aria-describedby]="'impact-help'">
          <div class="range-labels">
            <span>Baixo Impacto (1)</span>
            <span class="current-value" aria-live="polite">{{ impact_score }}</span>
            <span>Alto Impacto (5)</span>
          </div>
          <small id="impact-help" class="form-help">Qual o impacto nos seus objetivos?</small>
        </div>
      </div>

      <div class="priority-preview" 
           role="status"
           aria-label="Score de prioridade calculado">
        <strong>Score de Prioridade Calculado:</strong> 
        <span class="priority-score" [class.high-priority]="getPriorityPreview() >= 5">
          {{ getPriorityPreview() }}
        </span>
      </div>
    </div>

    <!-- Additional Information -->
    <div class="form-section">
      <h4>🏷️ Informações Adicionais</h4>
      
      <div class="form-group">
        <label for="labels">Tags/Labels (separadas por vírgula)</label>
        <input 
          type="text" 
          id="labels"
          class="form-control" 
          [(ngModel)]="labels" 
          name="labels"
          placeholder="Ex: trabalho, urgente, cliente-abc"
          [attr.aria-describedby]="'labels-help'">
        <small id="labels-help" class="form-help">Use vírgulas para separar múltiplas tags</small>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="form-actions">
      <button 
        type="submit" 
        class="btn btn-primary btn-create"
        [class.loading]="isSubmitting"
        [disabled]="!title.trim() || isSubmitting"
        [attr.aria-label]="isSubmitting ? 'Criando tarefa...' : 'Criar nova tarefa'">
        <span *ngIf="isSubmitting" class="loading-spinner" aria-hidden="true"></span>
        <span class="btn-icon" *ngIf="!isSubmitting" aria-hidden="true">➕</span>
        {{ isSubmitting ? 'Criando...' : 'Criar Tarefa' }}
      </button>
    </div>
  </form>
</div>
